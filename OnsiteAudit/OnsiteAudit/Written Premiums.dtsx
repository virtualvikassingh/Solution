<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="3/29/2018 4:30:33 AM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="ACF-EWAQW01"
  DTS:CreatorName="ACFS24\kumarr"
  DTS:DTSID="{2F9F7A62-6DC2-428C-91A5-A1F4E486860C}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="13.0.2165.0"
  DTS:LocaleID="1033"
  DTS:ObjectName="Written Premiums"
  DTS:PackageType="5"
  DTS:VersionBuild="32"
  DTS:VersionGUID="{BB7BC9F1-AF3D-4C33-82A0-26EA75AF9B82}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[ACF-EWRPW01.EDW]"
      DTS:CreationName="OLEDB"
      DTS:DTSID="{C7AB6134-4CC2-4580-9179-9E95CA43B86E}"
      DTS:ObjectName="ACF-EWRPW01.EDW">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=ACF-EWRPW01;Initial Catalog=EDW;Provider=SQLNCLI11.1;Integrated Security=SSPI;Auto Translate=False;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[Flat File Connection Manager]"
      DTS:CreationName="FLATFILE"
      DTS:DTSID="{A5D28494-F658-4825-93E9-D7932A63F196}"
      DTS:ObjectName="Flat File Connection Manager">
      <DTS:PropertyExpression
        DTS:Name="ConnectionString">@[$Project::FilePath]+"osap_np2_"+(DT_WSTR,4)DatePart("yyyy", GetDate()) + RIGHT("0" + (DT_WSTR,2)DatePart("mm", GetDate()), 2) + RIGHT("0" + (DT_WSTR,2)DatePart("dd", GetDate()), 2)+ ".txt"</DTS:PropertyExpression>
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:Format="RaggedRight"
          DTS:LocaleID="1033"
          DTS:HeaderRowDelimiter="_x000D__x000A_"
          DTS:RowDelimiter=""
          DTS:TextQualifier="_x003C_none_x003E_"
          DTS:CodePage="1252"
          DTS:ConnectionString="E:\Solution\Outbound Reports\OnsiteAudit\osap_np2_20181123.txt">
          <DTS:FlatFileColumns>
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="5"
              DTS:MaximumWidth="5"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="CARRIER CODE"
              DTS:DTSID="{73DF04B7-2969-4ACF-AF69-0D3E561C22BA}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="5"
              DTS:MaximumWidth="5"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="CARRIER PUP CODE"
              DTS:DTSID="{63D73C9B-04DB-4CF8-BF45-2891DF7F96A9}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="2"
              DTS:MaximumWidth="2"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="POOL CODE"
              DTS:DTSID="{54A8B664-9DE4-443D-A146-BB6A3AAC8469}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="4"
              DTS:MaximumWidth="4"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="REPORT CODE"
              DTS:DTSID="{AC560BF5-4366-46C1-9622-A3BB743A9131}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="8"
              DTS:MaximumWidth="8"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="CURRENT QUARTER END DATE"
              DTS:DTSID="{9D4EE227-B91E-4E1D-92E5-63187F8A80A5}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="1"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="PREMIUM TYPE"
              DTS:DTSID="{82DFDE2B-15C9-4FD8-BCDC-5D9A5BD5D17F}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="2"
              DTS:MaximumWidth="2"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="GOVERNING STATE CODE"
              DTS:DTSID="{CFD38BE9-D902-496A-B5DA-A138D7E62E01}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="90"
              DTS:MaximumWidth="90"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="NAME OF INSURED"
              DTS:DTSID="{0D605337-3074-4477-8C60-946DB88680B9}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="18"
              DTS:MaximumWidth="18"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="POLICY NUMBER IDENTIFIER"
              DTS:DTSID="{1F9B19AF-7332-4137-B009-F21825084D96}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="8"
              DTS:MaximumWidth="8"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="POLICY EFFECTIVE DATE"
              DTS:DTSID="{391DC2F1-211A-4121-AF10-77ADAB8127AE}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="8"
              DTS:MaximumWidth="8"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="POLICY EXPIRATION DATE"
              DTS:DTSID="{73FEFA39-6886-48F4-9837-30501B4EEC7D}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="2"
              DTS:MaximumWidth="2"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="NEW/RENEWAL INDICATOR"
              DTS:DTSID="{9194CF1F-DC9E-4994-BC2E-12B9E349C694}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="1"
              DTS:MaximumWidth="1"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="MULTISTATE INDICATOR"
              DTS:DTSID="{816FB164-89C4-4DD5-A0D4-46B600B29588}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="12"
              DTS:MaximumWidth="12"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="TOTAL PREMIUM"
              DTS:DTSID="{E0E97D7C-7FFC-4529-A61D-134530C1B2C5}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnDelimiter=""
              DTS:ColumnWidth="12"
              DTS:MaximumWidth="12"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="PRODUCER FEE"
              DTS:DTSID="{A27344BD-E7B0-45C7-8D3C-C118B8D027C2}"
              DTS:CreationName="" />
            <DTS:FlatFileColumn
              DTS:ColumnType="Delimited"
              DTS:ColumnDelimiter="_x000D__x000A_"
              DTS:MaximumWidth="12"
              DTS:DataType="129"
              DTS:TextQualified="True"
              DTS:ObjectName="UNEARNED PREMIUM"
              DTS:DTSID="{84E8E887-E015-497B-9B1C-B3178A37F3C6}"
              DTS:CreationName="" />
          </DTS:FlatFileColumns>
        </DTS:ConnectionManager>
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Generating Files"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{29CB996B-0697-46EF-83B5-9447EBCE62B4}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Generating Files"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Generating Files\Flat File Destination"
              componentClassID="Microsoft.FlatFileDestination"
              contactInfo="Flat File Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;0"
              description="Flat File Destination"
              localeId="1033"
              name="Flat File Destination">
              <properties>
                <property
                  dataType="System.Boolean"
                  description="Specifies whether the data will overwrite or append to the destination file."
                  name="Overwrite">true</property>
                <property
                  dataType="System.Null"
                  description="Specifies the text to write to the destination file before any data is written."
                  expressionType="Notify"
                  name="Header" />
              </properties>
              <connections>
                <connection
                  refId="Package\Generating Files\Flat File Destination.Connections[FlatFileConnection]"
                  connectionManagerID="Package.ConnectionManagers[Flat File Connection Manager]"
                  connectionManagerRefId="Package.ConnectionManagers[Flat File Connection Manager]"
                  name="FlatFileConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input]"
                  hasSideEffects="true"
                  name="Flat File Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[CARRIER CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="CARRIER CODE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CARRIER CODE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER CODE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[CARRIER PUP CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="CARRIER PUP CODE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CARRIER PUP CODE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[POOL CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="POOL CODE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POOL CODE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[REPORT CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="REPORT CODE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[REPORT CODE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[CURRENT QUARTER END DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="CURRENT QUARTER END DATE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CURRENT QUARTER END DATE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[PREMIUM TYPE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="PREMIUM TYPE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[PREMIUM TYPE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[GOVERNING STATE CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="GOVERNING STATE CODE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[GOVERNING STATE CODE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[NAME OF INSURED]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="90"
                      cachedName="NAME OF INSURED"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NAME OF INSURED]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[POLICY NUMBER IDENTIFIER]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="18"
                      cachedName="POLICY NUMBER IDENTIFIER"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[POLICY EFFECTIVE DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="POLICY EFFECTIVE DATE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY EFFECTIVE DATE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[POLICY EXPIRATION DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="POLICY EXPIRATION DATE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY EXPIRATION DATE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[NEW/RENEWAL INDICATOR]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="NEW/RENEWAL INDICATOR"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[MULTISTATE INDICATOR]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="MULTISTATE INDICATOR"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MULTISTATE INDICATOR]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[TOTAL PREMIUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="TOTAL PREMIUM"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[TOTAL PREMIUM]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[PRODUCER FEE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="PRODUCER FEE"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[PRODUCER FEE]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]" />
                    <inputColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].Columns[UNEARNED PREMIUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="UNEARNED PREMIUM"
                      externalMetadataColumnId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[UNEARNED PREMIUM]"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CARRIER CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER PUP CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="POOL CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="REPORT CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="CURRENT QUARTER END DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="PREMIUM TYPE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="GOVERNING STATE CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="90"
                      name="NAME OF INSURED" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="18"
                      name="POLICY NUMBER IDENTIFIER" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EFFECTIVE DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EXPIRATION DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="NEW/RENEWAL INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="MULTISTATE INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="TOTAL PREMIUM" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="PRODUCER FEE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input].ExternalColumns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="UNEARNED PREMIUM" />
                  </externalMetadataColumns>
                </input>
              </inputs>
            </component>
            <component
              refId="Package\Generating Files\OLE DB Source"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[OnsiteAuditWrittenPremium]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">0</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Generating Files\OLE DB Source.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER CODE]"
                      length="5"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER CODE]"
                      name="CARRIER CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER PUP CODE]"
                      length="5"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]"
                      name="CARRIER PUP CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POOL CODE]"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]"
                      name="POOL CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[REPORT CODE]"
                      length="4"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]"
                      name="REPORT CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CURRENT QUARTER END DATE]"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]"
                      name="CURRENT QUARTER END DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PREMIUM TYPE]"
                      length="1"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]"
                      name="PREMIUM TYPE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[GOVERNING STATE CODE]"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]"
                      name="GOVERNING STATE CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NAME OF INSURED]"
                      length="90"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]"
                      name="NAME OF INSURED"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      length="18"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]"
                      name="POLICY NUMBER IDENTIFIER"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EFFECTIVE DATE]"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]"
                      name="POLICY EFFECTIVE DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EXPIRATION DATE]"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]"
                      name="POLICY EXPIRATION DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]"
                      name="NEW/RENEWAL INDICATOR"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[MULTISTATE INDICATOR]"
                      length="1"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]"
                      name="MULTISTATE INDICATOR"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[TOTAL PREMIUM]"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]"
                      name="TOTAL PREMIUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PRODUCER FEE]"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]"
                      name="PRODUCER FEE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[UNEARNED PREMIUM]"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]"
                      name="UNEARNED PREMIUM"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER PUP CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="POOL CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="REPORT CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="CURRENT QUARTER END DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="PREMIUM TYPE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="GOVERNING STATE CODE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="90"
                      name="NAME OF INSURED" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="18"
                      name="POLICY NUMBER IDENTIFIER" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EFFECTIVE DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EXPIRATION DATE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="NEW/RENEWAL INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="MULTISTATE INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="TOTAL PREMIUM" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="PRODUCER FEE" />
                    <externalMetadataColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="UNEARNED PREMIUM" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER CODE]"
                      name="CARRIER CODE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER PUP CODE]"
                      name="CARRIER PUP CODE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POOL CODE]"
                      name="POOL CODE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[REPORT CODE]"
                      name="REPORT CODE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CURRENT QUARTER END DATE]"
                      name="CURRENT QUARTER END DATE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PREMIUM TYPE]"
                      name="PREMIUM TYPE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[GOVERNING STATE CODE]"
                      name="GOVERNING STATE CODE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="90"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NAME OF INSURED]"
                      name="NAME OF INSURED" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="18"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY NUMBER IDENTIFIER]"
                      name="POLICY NUMBER IDENTIFIER" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EFFECTIVE DATE]"
                      name="POLICY EFFECTIVE DATE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EXPIRATION DATE]"
                      name="POLICY EXPIRATION DATE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NEW/RENEWAL INDICATOR]"
                      name="NEW/RENEWAL INDICATOR" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[MULTISTATE INDICATOR]"
                      name="MULTISTATE INDICATOR" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[TOTAL PREMIUM]"
                      name="TOTAL PREMIUM" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PRODUCER FEE]"
                      name="PRODUCER FEE" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[UNEARNED PREMIUM]"
                      name="UNEARNED PREMIUM" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Generating Files.Paths[OLE DB Source Output]"
              endId="Package\Generating Files\Flat File Destination.Inputs[Flat File Destination Input]"
              name="OLE DB Source Output"
              startId="Package\Generating Files\OLE DB Source.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\pulling data into final table"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{D4D83802-3007-480D-B0ED-00FCE97BEBC3}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="pulling data into final table"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\pulling data into final table\OLE DB Destination"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="OLE DB Destination"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[OnsiteAuditWrittenPremium]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">true</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">true</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\pulling data into final table\OLE DB Destination.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[Carrier Code]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="Carrier Code"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CARRIER CODE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Carrier Code]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[CARRIER PUP CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="5"
                      cachedName="CARRIER PUP CODE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CARRIER PUP CODE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[POOL CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="POOL CODE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POOL CODE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[REPORT CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="4"
                      cachedName="REPORT CODE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[REPORT CODE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[CURRENT QUARTER END DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="CURRENT QUARTER END DATE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CURRENT QUARTER END DATE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[PREMIUM TYPE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="PREMIUM TYPE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[PREMIUM TYPE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[GOVERNING STATE CODE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="GOVERNING STATE CODE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[GOVERNING STATE CODE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[NAME OF INSURED]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="255"
                      cachedName="NAME OF INSURED"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[NAME OF INSURED]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[POLICY NUMBER IDENTIFIER]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="50"
                      cachedName="POLICY NUMBER IDENTIFIER"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[POLICY EFFECTIVE DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="POLICY EFFECTIVE DATE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY EFFECTIVE DATE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[POLICY EXPIRATION DATE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="8"
                      cachedName="POLICY EXPIRATION DATE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY EXPIRATION DATE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[NEW/RENEWAL INDICATOR]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="NEW/RENEWAL INDICATOR"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[MULTISTATE INDICATOR]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="1"
                      cachedName="MULTISTATE INDICATOR"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[MULTISTATE INDICATOR]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[TOTAL PREMIUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="TOTAL PREMIUM"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[TOTAL PREMIUM]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[PRODUCER FEE]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="PRODUCER FEE"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[PRODUCER FEE]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]" />
                    <inputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].Columns[UNEARNED PREMIUM]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="12"
                      cachedName="UNEARNED PREMIUM"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[UNEARNED PREMIUM]"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CARRIER CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER PUP CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="POOL CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="REPORT CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="CURRENT QUARTER END DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="PREMIUM TYPE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="GOVERNING STATE CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="90"
                      name="NAME OF INSURED" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="18"
                      name="POLICY NUMBER IDENTIFIER" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EFFECTIVE DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EXPIRATION DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="NEW/RENEWAL INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="MULTISTATE INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="TOTAL PREMIUM" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="PRODUCER FEE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input].ExternalColumns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="UNEARNED PREMIUM" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\pulling data into final table\OLE DB Destination.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\pulling data into final table\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\pulling data into final table\OLE DB Destination.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\pulling data into final table\OLE DB Source"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">Declare @QuarterEndDate Date='2018-03-31';
Declare @QuarterStartDate Date='2018-01-01';
With CTE_Cancelled As(
Select distinct policynumber,effectivedate,convert(varchar(8),Format(CancellationDate,'yyyyMMdd')) CancellationDate from (
select policynumber,effectivedate,JobCreateTime,CancellationDate,dense_rank() over(partition by policynumber,effectivedate 
order by jobupdatetime desc) rank 
from dimpolicy where policystatus in ('Bound') 
) m where rank=1 and CancellationDate is not null 
)

,CTE_Renewal As(
Select distinct policynumber, 1 as Renewal from dimpolicy where TransactionType ='Renewal' and PolicyStatus ='Bound'
)

,CTE_RenewalExpiration As(
Select * from (
Select Expirationdate,p.PolicyNumber,p.effectivedate,p.TermNumber, row_number() over (partition by p.PolicyNumber,p.TermNumber order by jobclosedate desc) rank 
from (select * from dimpolicy where modelnumber is not null) p where p.jobclosedate &gt; 
(select JobCloseDate from dimpolicy p1 where p1.policynumber=p.policynumber and p.TermNumber=p1.termnumber-1 and p1.TransactionType in ('Renewal','Rewrite')
and p1.PolicyStatus='Bound' and p1.policynumber not in ('ARP120006138','ARP120004800')) and jobclosedate is not null and policynumber is not null and termnumber is not null 
) m where m.rank=1
union all
Select * from (
Select Expirationdate,p.PolicyNumber,p.effectivedate,p.TermNumber, row_number() over (partition by p.PolicyNumber,p.TermNumber order by jobclosedate desc) rank 
from (select * from dimpolicy where modelnumber is not null) p where p.jobclosedate &gt;= 
(select JobCloseDate from dimpolicy p1 where p1.policynumber=p.policynumber and p.termnumber=p1.termnumber and p1.TransactionType in('Renewal','Rewrite') 
and p1.PolicyStatus='Bound' and p1.policynumber &lt;&gt; 'ARP120006138')  and jobclosedate is not null and policynumber is not null and termnumber is not null
) n where rank=1
) 

,CTE_AllExpiration As (
Select * from (
select Expirationdate,p.PolicyNumber,p.effectivedate, row_number() over (partition by p.PolicyNumber,p.effectivedate order by jobclosedate desc) rank 
from dimpolicy p where jobclosedate is not null and policynumber is not null and termnumber is not null
) l where rank=1
)


,CTE_GoverningClass As (
 Select * from (
select policynumber,effectivedate,GoverningClassCode,row_number() over(partition by policynumber,effectivedate
order by JobUpdateTime desc ) rank 
 from DimPolicy where policynumber is not null and termnumber is not null) m where rank=1
 )

,CTE_Commission As
(
Select p.PolicyNumber,P.EffectiveDate,
--Datepart(year,P.EffectiveDate) As "PolicyYear", 
--Po2.PrimaryInsuredName  As PrimaryInsuredName,
P.RatingPlan,
--DATEPART(YEAR,p.EffectiveDate) *100 + DATEPART(MONTH,p.EffectiveDate) As 'EffectiveDateMonthYear' 
Sum(case when BT.TransactionTypeCode = 'ReserveCmsnEarned' then BT.TransactionAmount else 0 end ) As CommissionAmount
from  FactBillingTransaction f
Inner Join DimBillingTransaction BT on F.BillingTransactionID = BT.BillingTransactionID  
inner join  DimPolicy p on f.PolicyID = p.PolicyID
inner join  DimAgency a on f.AgencyID = a.AgencyID
inner join  DimProducer pr on f.ProducerID = pr.ProducerID
inner join  DimCompany c on f.CompanyID = c.CompanyID
inner join  DimBillingAccount ac on f.BillingAccountID = ac.BillingAccountID
left join (select PolicyNumber,PrimaryInsuredName,RatingPlan,row_number() over (partition by policynumber order by TermNumber desc ) as rn  
           from DimPolicy where MostRecentModel=1) Po2 on  p.policynumber=Po2.PolicyNumber and po2.rn=1

where  BT.TransactionTypeCode='ReserveCmsnEarned' and
BT.LedgersideName = 'Debit'  and p.PolicyNumber &lt;&gt; '-1' 
and f.LegacySourceSystem = 'WC' 
--and P.BaseState ='MI'
and convert(date,BT.TransactionDate)&gt;='2017-12-01' and convert(date,BT.TransactionDate)&lt;='2018-02-28' 
group by p.PolicyNumber,P.EffectiveDate,P.RatingPlan
)

Select * from (
select	'19968'	[Carrier Code],
		'19968'	[CARRIER PUP CODE],
		Case BaseState when 'MI' Then '15' when 'IN' then '13' when 'WI' then '48' when 'NM' then '08' when 'ME' then '16'
			when 'MA' then '18' when 'TN' then '19' else '12' End [POOL CODE],
		Case When po.RatingPlan='Rating Plan A' then '0300' when po.RatingPlan='Rating Plan B' then '0400' when po.RatingPlan='Rating Plan C' then '0500' 
			When Basestate in ('IN','MA','WI') then '0100' when Basestate not in ('MI','IN','WI','NM','ME','MA','TN') and gov.GoverningClassCode in 
			('1016','1005','0164','0168','0156','0161','0162') then '0200' when Basestate not in ('MI','IN','WI','NM','ME','MA','TN') and 
			gov.GoverningClassCode not in ('1016','1005','0164','0168','0156','0161','0162') then '0100' End  As  
		[REPORT CODE],
		convert(varchar(8),Format(@QuarterEndDate,'yyyyMMdd')) [CURRENT QUARTER END DATE],
		Case when po.GoverningClassCode in ('1005','1006','0156','0158','0164','0161','0162') then 'O' else 'T' end As [PREMIUM TYPE],
		Case po.BaseState 
			when 'AL' then '01'	when 'AK' then '54' when 'AZ' then '02'	when 'AR' then '03'	when 'CA' then '04' when 'CO' then '05'
			when 'CT' then '06'	when 'DE' then '07'	when 'DC' then '08'	when 'FL' then '09'	when 'GA' then '10' when 'HI' then '52'
			when 'ID' then '11'	when 'IL' then '12'	when 'IN' then '13'	when 'IA' then '14'	when 'KS' then '15'	when 'KY' then '16'
			when 'LA' then '17'	when 'ME' then '18'	when 'MD' then '19'	when 'MA' then '20'	when 'MI' then '21'	when 'MN' then '22'
			when 'MS' then '23'	when 'MO' then '24'	when 'MT' then '25'	when 'NE' then '26'	when 'NV' then '27'	when 'NH' then '28'
			when 'NJ' then '29'	when 'NM' then '30'	when 'NY' then '31'	when 'NC' then '32'	when 'ND' then '33'	when 'OH' then '34'
			when 'OK' then '35'	when 'OR' then '36'	when 'PA' then '37'	when 'RI' then '38'	when 'SC' then '39'	when 'SD' then '40'
			when 'TN' then '41'	when 'TX' then '42'	when 'UT' then '43'	when 'VT' then '44'	when 'VA' then '45'	when 'WA' then '46'
			when 'WV' then '47'	when 'WI' then '48'	when 'WY' then '49'	End [GOVERNING STATE CODE],
		--po.BaseState [GOVERNING STATE CODE],
		po.PrimaryInsuredName [NAME OF INSURED],
		po.PolicyNumber [POLICY NUMBER IDENTIFIER],
		convert(varchar(8),Format(po.EffectiveDate,'yyyyMMdd')) [POLICY EFFECTIVE DATE],
		convert(varchar(8),Format(coalesce(cnl.CancellationDate,coalesce(ex.ExpirationDate,eax.ExpirationDate)),'yyyyMMdd'))  [POLICY EXPIRATION DATE],
		Case when ren.Renewal=1 then '02' else '01' end [NEW/RENEWAL INDICATOR],
		'N' [MULTISTATE INDICATOR],
		Case when GrossWrittenAmount&lt;0 then convert(varchar(12),format(ISNULL(GrossWrittenAmount,0),'00000000000'))
		else convert(varchar(12),format(ISNULL(GrossWrittenAmount,0),'000000000000')) end [TOTAL PREMIUM],
		Case when CommissionAmount&lt;0 then convert(varchar(12),format(ISNULL(CommissionAmount,0),'00000000000')) 
		else convert(varchar(12),format(ISNULL(CommissionAmount,0),'000000000000')) end [PRODUCER FEE],
		Case when UnearnedPremium&lt;0 then convert(varchar(12),format(ISNULL(UnearnedPremium,0),'00000000000')) 
		else convert(varchar(12),format(ISNULL(UnearnedPremium,0),'000000000000')) end [UNEARNED PREMIUM]
From 
(select distinct policynumber,effectivedate,ratingplan,PrimaryInsuredName ,GoverningClassCode,BaseState from (
select *,row_number() over( partition by  policynumber,effectivedate order by jobupdatetime desc) rank from dimpolicy ) m where rank=1 --and BaseState='MI' 
and PolicyNumber is not null and convert(date,EffectiveDate)&lt;=@QuarterEndDate)  po Left Join
(Select t1.A_Policynumber,t1.A_EffectiveDate,t1.A_ratingPlan,Sum(t2.Q_MTDWritten) GrossWrittenAmount,sum(t1.A_MTDWritten-t1.A_MTDEarned) UnearnedPremium
 from OnsiteAuditWrittenPremiumAStagging t1 left join OnsiteAuditWrittenPremiumQStagging t2 on  t1.A_PolicyNumber=t2.Q_PolicyNumber and t1.A_YearMonth=t2.Q_YearMonth and t1.A_EffectiveDate=t2.Q_EffectiveDate 
and t1.A_RatingPlan=t2.Q_ratingPlan
group by t1.A_Policynumber,t1.A_EffectiveDate,t1.A_ratingPlan) prem 
ON po.policynumber=prem.A_PolicyNumber and po.effectivedate=prem.A_EffectiveDate and prem.A_ratingplan=po.ratingplan 
Left Join CTE_Cancelled cnl ON cnl.PolicyNumber=po.policynumber and cnl.effectivedate=po.EffectiveDate
Left Join CTE_Renewal ren ON ren.PolicyNumber=po.policynumber
Left Join CTE_RenewalExpiration ex ON ex.PolicyNumber=po.policynumber and ex.effectivedate=po.effectivedate
Left Join CTE_AllExpiration  eax ON eax.PolicyNumber=po.policynumber and eax.effectivedate=po.effectivedate
Left Join CTE_GoverningClass gov ON gov.PolicyNumber=po.policynumber and gov.effectivedate=po.effectivedate
Left Join CTE_Commission comm On comm.PolicyNumber=po.policynumber and comm.effectivedate=po.effectivedate and po.ratingplan=comm.ratingplan

) m --where not ([TOTAL PREMIUM]=0 and [PRODUCER FEE]=0 and [UNEARNED PREMIUM]=0)</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\pulling data into final table\OLE DB Source.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Carrier Code]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Carrier Code]"
                      length="5"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Carrier Code]"
                      name="Carrier Code"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER PUP CODE]"
                      length="5"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CARRIER PUP CODE]"
                      name="CARRIER PUP CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POOL CODE]"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POOL CODE]"
                      name="POOL CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[REPORT CODE]"
                      length="4"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[REPORT CODE]"
                      name="REPORT CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CURRENT QUARTER END DATE]"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[CURRENT QUARTER END DATE]"
                      name="CURRENT QUARTER END DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PREMIUM TYPE]"
                      length="1"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PREMIUM TYPE]"
                      name="PREMIUM TYPE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[GOVERNING STATE CODE]"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[GOVERNING STATE CODE]"
                      name="GOVERNING STATE CODE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NAME OF INSURED]"
                      length="255"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NAME OF INSURED]"
                      name="NAME OF INSURED"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      length="50"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY NUMBER IDENTIFIER]"
                      name="POLICY NUMBER IDENTIFIER"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EFFECTIVE DATE]"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EFFECTIVE DATE]"
                      name="POLICY EFFECTIVE DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EXPIRATION DATE]"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[POLICY EXPIRATION DATE]"
                      name="POLICY EXPIRATION DATE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[NEW/RENEWAL INDICATOR]"
                      name="NEW/RENEWAL INDICATOR"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[MULTISTATE INDICATOR]"
                      length="1"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[MULTISTATE INDICATOR]"
                      name="MULTISTATE INDICATOR"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[TOTAL PREMIUM]"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[TOTAL PREMIUM]"
                      name="TOTAL PREMIUM"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PRODUCER FEE]"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[PRODUCER FEE]"
                      name="PRODUCER FEE"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[UNEARNED PREMIUM]"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].Columns[UNEARNED PREMIUM]"
                      name="UNEARNED PREMIUM"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Carrier Code]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="Carrier Code" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      name="CARRIER PUP CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="POOL CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      name="REPORT CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="CURRENT QUARTER END DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="PREMIUM TYPE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="GOVERNING STATE CODE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="NAME OF INSURED" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="POLICY NUMBER IDENTIFIER" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EFFECTIVE DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      name="POLICY EXPIRATION DATE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="NEW/RENEWAL INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      name="MULTISTATE INDICATOR" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="TOTAL PREMIUM" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="PRODUCER FEE" />
                    <externalMetadataColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      name="UNEARNED PREMIUM" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Carrier Code]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Carrier Code]"
                      name="Carrier Code" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER PUP CODE]"
                      codePage="1252"
                      dataType="str"
                      length="5"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CARRIER PUP CODE]"
                      name="CARRIER PUP CODE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POOL CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POOL CODE]"
                      name="POOL CODE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[REPORT CODE]"
                      codePage="1252"
                      dataType="str"
                      length="4"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[REPORT CODE]"
                      name="REPORT CODE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CURRENT QUARTER END DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[CURRENT QUARTER END DATE]"
                      name="CURRENT QUARTER END DATE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PREMIUM TYPE]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PREMIUM TYPE]"
                      name="PREMIUM TYPE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[GOVERNING STATE CODE]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[GOVERNING STATE CODE]"
                      name="GOVERNING STATE CODE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NAME OF INSURED]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NAME OF INSURED]"
                      name="NAME OF INSURED" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY NUMBER IDENTIFIER]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY NUMBER IDENTIFIER]"
                      name="POLICY NUMBER IDENTIFIER" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EFFECTIVE DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EFFECTIVE DATE]"
                      name="POLICY EFFECTIVE DATE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EXPIRATION DATE]"
                      codePage="1252"
                      dataType="str"
                      length="8"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[POLICY EXPIRATION DATE]"
                      name="POLICY EXPIRATION DATE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NEW/RENEWAL INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[NEW/RENEWAL INDICATOR]"
                      name="NEW/RENEWAL INDICATOR" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[MULTISTATE INDICATOR]"
                      codePage="1252"
                      dataType="str"
                      length="1"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[MULTISTATE INDICATOR]"
                      name="MULTISTATE INDICATOR" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[TOTAL PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[TOTAL PREMIUM]"
                      name="TOTAL PREMIUM" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PRODUCER FEE]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[PRODUCER FEE]"
                      name="PRODUCER FEE" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[UNEARNED PREMIUM]"
                      codePage="1252"
                      dataType="str"
                      length="12"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[UNEARNED PREMIUM]"
                      name="UNEARNED PREMIUM" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\pulling data into final table.Paths[OLE DB Source Output]"
              endId="Package\pulling data into final table\OLE DB Destination.Inputs[OLE DB Destination Input]"
              name="OLE DB Source Output"
              startId="Package\pulling data into final table\OLE DB Source.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Pulling Data into stagging table"
      DTS:CreationName="Microsoft.Pipeline"
      DTS:Description="Data Flow Task"
      DTS:DTSID="{2883349B-81CB-4B88-ADC4-DCF9433E9930}"
      DTS:ExecutableType="Microsoft.Pipeline"
      DTS:LocaleID="-1"
      DTS:ObjectName="Pulling Data into stagging table"
      DTS:TaskContact="Performs high-performance data extraction, transformation and loading;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1">
      <DTS:Variables />
      <DTS:ObjectData>
        <pipeline
          version="1">
          <components>
            <component
              refId="Package\Pulling Data into stagging table\AStagging"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="AStagging"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[OnsiteAuditWrittenPremiumAStagging]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Pulling Data into stagging table\AStagging.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_LookupCol]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="81"
                      cachedName="A_LookupCol"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_LookupCol]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_LookupCol]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_ReportMonth]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="33"
                      cachedName="A_ReportMonth"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_ReportMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ReportMonth]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_YearMonth]"
                      cachedDataType="i4"
                      cachedName="A_YearMonth"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YearMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YearMonth]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_PolicyNumber]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="50"
                      cachedName="A_PolicyNumber"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_PolicyNumber]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PolicyNumber]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_EffectiveDate]"
                      cachedDataType="dbTimeStamp"
                      cachedName="A_EffectiveDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_EffectiveDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_EffectiveDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_PremiumState]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="A_PremiumState"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_PremiumState]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PremiumState]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_MTDWritten]"
                      cachedDataType="cy"
                      cachedName="A_MTDWritten"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_MTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDWritten]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_YTDWritten]"
                      cachedDataType="cy"
                      cachedName="A_YTDWritten"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDWritten]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_ExpirationDate]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="A_ExpirationDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_ExpirationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ExpirationDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_CancellationDate]"
                      cachedDataType="dbTimeStamp"
                      cachedName="A_CancellationDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_CancellationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_CancellationDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_Inforce]"
                      cachedDataType="cy"
                      cachedName="A_Inforce"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_Inforce]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_Inforce]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_MTDEarned]"
                      cachedDataType="numeric"
                      cachedName="A_MTDEarned"
                      cachedPrecision="22"
                      cachedScale="4"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_MTDEarned]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDEarned]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_YTDEARNED]"
                      cachedDataType="numeric"
                      cachedName="A_YTDEARNED"
                      cachedPrecision="38"
                      cachedScale="4"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YTDEARNED]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDEARNED]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].Columns[A_RatingPlan]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="256"
                      cachedName="A_RatingPlan"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_RatingPlan]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_RatingPlan]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_LookupCol" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_ReportMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YearMonth]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_YearMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_PolicyNumber" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_RatingPlan" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_EffectiveDate]"
                      dataType="dbTimeStamp"
                      name="A_EffectiveDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="A_PremiumState" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_MTDWritten]"
                      dataType="numeric"
                      name="A_MTDWritten"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YTDWritten]"
                      dataType="numeric"
                      name="A_YTDWritten"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_ExpirationDate]"
                      dataType="dbTimeStamp"
                      name="A_ExpirationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_CancellationDate]"
                      dataType="dbTimeStamp"
                      name="A_CancellationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_Inforce]"
                      dataType="numeric"
                      name="A_Inforce"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_MTDEarned]"
                      dataType="numeric"
                      name="A_MTDEarned"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input].ExternalColumns[A_YTDEARNED]"
                      dataType="numeric"
                      name="A_YTDEARNED"
                      precision="12"
                      scale="2" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Pulling Data into stagging table\AStagging.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\AStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\AStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\AStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Pulling Data into stagging table\OLE DB Source"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">Declare @QuarterEndDate Date;
Declare @QuarterStartDate Date;
Declare @PreviousQuarterStartDate Date;
Declare @PreviousQuarterEndDate Date;
Declare @Scheduled int;
Declare @ReportDate as Date;
Set @ReportDate = (Select Date from DimDate where IsLastDayOfMonth =1 and QuarterofYear = 1 and Year ='2018' and MonthofYear in (3,6,9,12));
SET @QuarterStartDate	 =  DATEADD(q, DATEDIFF(q, 0, @ReportDate), 0);
SET @QuarterEndDate		 =  DATEADD(d, -1, DATEADD(q, DATEDIFF(q, 0, @ReportDate) + 1, 0)) ;
Set @PreviousQuarterStartDate	= DATEADD(qq, DATEDIFF(qq, 0, @QuarterStartDate) -1, 0);
Set @PreviousQuarterEndDate		= DATEADD (dd, -1, DATEADD(qq, DATEDIFF(qq, 0, @QuarterStartDate), 0));
Declare @StartYear int= year(@ReportDate);
Declare @EndMonth int=month(@ReportDate);
Declare @EndYear int= year(@ReportDate);
Declare @startmonth int=month(@QuarterStartDate);


With CTE_MonthParam As
(
Select Year,MonthName,MonthofYear,Cast(Min(Date) as date) As 'ReportStartDate',CAst(Max(Date) as date) As 'ReportEndDate',
cast(DATEADD(yy, DATEDIFF(yy, 0, Cast(Min(Date) as date)), 0) as Date) As 'YTDStartDate',
DATEFROMPARTS(DATEPART(yyyy, Cast(Min(Date) as date)) - 1, 1, 1) As  PrevYearStartDate ,
cast(DATEADD(DD, -1, DATEADD(YY, DATEDIFF(yy, 0, Cast(Min(Date) as date)), 0)) as date) As PrevYearEndDate
from DimDate 
where Year*100 + MonthofYear &gt;=  @StartYear*100 +  1
and Year*100 + MonthofYear &lt;=  @EndYear*100 +  @EndMonth
and (DayofMonth = 1  or IsLastDayOfMonth = 1)  
Group by Year,MonthName,MonthofYear 
)

,CTE_Temp as (
SELECT 
	LookupCol, ReportMonth,Year,YearMonth, PolicyNumber,RatingPlan, EffectiveDate, PremiumState, 
	MTDWritten, YTDWritten, 
	ExpirationDate, 
	CancellationDate, Inforce, 
	MTDEarned = 
	CASE 
		WHEN CancellationDate &lt;=  ReportStartDate AND CancellationCloseDate &lt;=  ReportStartDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN MTDWritten 
		ELSE MTDEarned 
	END
FROM
(

SELECT
	CONCAT(PolicyNumber, ' ', CAST(EffectiveDate AS varchar)) AS LookupCol, 
	RIGHT('0' + CAST(MONTH( ReportStartDate) AS varchar), 2) + '-' + CAST(YEAR( ReportStartDate) AS varchar) ReportMonth,
	PolicyNumber,RatingPlan, EffectiveDate, PremiumState, ReportStartDate,
		ReportEndDate,Year,YearMonth,

	CASE 
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND CurrTransactionType &lt;&gt; 'AUDIT' THEN 0 
		ELSE CAST(MTDWritten AS money) 
	END AS MTDWritten, 

	CASE 
		WHEN YEAR(EffectiveDate) = YEAR( ReportStartDate) THEN YTDWritten 
		ELSE YTDWritten-YTDWrittenPrev 
	END AS YTDWritten, 

	ExpirationDate, CancellationCloseDate, CancellationWithdrawCloseDate, 

	CASE 
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'SUBMISSION' THEN CancellationDate
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION'  AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN CancellationDate
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN CancellationDate
		WHEN CancellationDate &lt;  ReportStartDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED')  THEN CancellationDate
		WHEN CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN CancellationDate
		WHEN CancellationDate &lt;=  ReportEndDate AND CancellationCloseDate &lt;=  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN CancellationDate
		ELSE NULL 
	END AS CancellationDate, 

	CASE 
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'SUBMISSION' THEN 0
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION'  AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN 0
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN 0
		WHEN CancellationDate &lt;  ReportStartDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED')  THEN 0
		WHEN CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN 0
		WHEN CancellationDate &lt;=  ReportEndDate AND CancellationCloseDate &lt;=  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN 0
		ELSE CAST(YTDWritten AS money) 
	END AS Inforce, 

	CASE
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND Total = LastTotal THEN 0
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND Total &lt;&gt; LastTotal THEN Total - LastTotal 
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate &lt;  ReportStartDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN 0 

		WHEN (CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate OR CancellationDate &gt;  ReportEndDate) AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate AND Total = 0 THEN 0 
		WHEN (CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate OR CancellationDate &gt;  ReportEndDate) AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate AND LastNonAuditTransactionType = 'CANCELLATION' THEN Total - LastTotal -- Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)

		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN Total - LastTotal -- ARP120000089
		WHEN LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND CancellationDate &lt;=  ReportEndDate THEN Total - LastTotal
		WHEN LastNonAuditTransactionType = 'CANCELLATION' AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal		
		WHEN LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND ISNULL(CurrTransactionType, '') &lt;&gt; 'CANCELLATION' THEN CAST(Total/TotalDays AS decimal(10,4))*(DaysInMonth + DATEDIFF(dd, EffectiveDate,  ReportStartDate)) - LastTotal-- WHEN Cancellation was bound last month, hence everything was earned by in last month itself -- -- ARP120000468
		WHEN LastNonAuditTransactionType = 'CANCELLATION' AND CurrTransactionType = 'Audit' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal	-- zz
		WHEN CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CancellationDate &lt;= ReportEndDate THEN Total-CAST((Total+(MTDWritten*-1))/TotalDays*DATEDIFF(dd, EffectiveDate, ReportStartDate) AS decimal(10,4))
		
		ELSE 
			CAST(Total/TotalDays AS decimal(10,4))*(DaysInMonth + CASE WHEN EffectiveDate &lt; ReportStartDate AND Total = MTDWritten THEN DATEDIFF(dd, EffectiveDate, ReportStartDate) ELSE 0 END)  -- ARP120000166
			+
			CASE WHEN EffectiveDate &lt; ReportStartDate AND Total &lt;&gt; MTDWritten AND MTDWritten &lt;&gt; 0 THEN CAST(MTDWritten/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate, ReportStartDate) ELSE 0 END -- ARP120000009
	END AS MTDEarned, 

	CurrTransactionType, CurrPolicyStatus, LastTransactionType, LastPolicyStatus, CurrNonAuditTransactionType, CurrNonAuditPolicyStatus, LastNonAuditTransactionType, 
	Total, LastTotal, TotalDays, ElapsedDays, DaysInMonth
FROM
(
	SELECT 
		ROW_NUMBER() OVER(PARTITION BY p.PolicyNumber, p.EffectiveDate,RP.Year,RP.MonthName ORDER BY CAST(CONVERT(VARCHAR, p.JobCloseDate, 101) AS datetime) DESC) RowNumber, 
		p.PolicyNumber, p.RatingPlan, p.BaseState PremiumState, 
		Year(EffectiveDate)PolicyYear,
		p.EffectiveDate,
		CONVERT(varchar, p.ExpirationDate, 101) ExpirationDate, 
		RP.ReportStartDate,
		RP.ReportEndDate,
		RP.Year,RP.Year*100 + RP.MonthofYear As YearMonth,

		Total = (SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'SUBMISSION', 'REINSTATEMENT', 'AUDIT', 'RENEWAL', 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC), 
		LastTotal = ISNULL((SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'SUBMISSION', 'REINSTATEMENT', 'AUDIT', 'RENEWAL', 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC), 0),

		MTDWritten =
		COALESCE
		(
			(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, CAST(CONVERT(VARCHAR, p1.EffectiveDate, 101) AS datetime), CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate  ORDER BY IIF(CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate, 1, 2), p1.JobCloseDate DESC)
			-
			ISNULL((SELECT top 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'SUBMISSION', 'RENEWAL', 'REWRITE', 'AUDIT') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, p1.EffectiveDate, CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) &lt; RP1.ReportStartDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC),  0)
			,
			ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, CAST(CONVERT(VARCHAR, p1.EffectiveDate, 101) AS datetime), CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate), 0)
		),

		YTDWritten =
		COALESCE
		(
		(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.ReportEndDate  ORDER BY p1.JobCloseDate DESC)
		,
		ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and  (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.ReportEndDate), 0)
		),

		YTDWrittenPrev =
		COALESCE
		(
		(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.PrevYearEndDate  ORDER BY p1.JobCloseDate DESC)
		,
		ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) BETWEEN RP1.PrevYearStartDate AND RP1.PrevYearEndDate), 0)
		),
		
		Inforce = ISNULL((SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'SUBMISSION') AND p1.PolicyStatus = 'BOUND' and p1.PolicyNumber = p.PolicyNumber and p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate AND CONVERT(varchar, p1.ExpirationDate, 101) &gt; RP1.ReportEndDate ORDER BY CASE WHEN p1.TransactionType = 'POLICY CHANGE' THEN 1 ELSE 2 END, p1.JobCloseDate), 0), 

		--Cancellation
		CancellationDate = (SELECT TOP 1 CAST(CONVERT(varchar, CancellationDate, 101)AS datetime) FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType = 'CANCELLATION' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),  
		CancellationCloseDate = (SELECT TOP 1 JobCloseDate FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and  p1.TransactionType IN ('CANCELLATION') AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate  AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC), 
		CancellationWithdrawCloseDate = (SELECT TOP 1 JobCloseDate FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and ((p1.TransactionType = 'REINSTATEMENT' AND p1.PolicyStatus = 'BOUND') OR (p1.TransactionType = 'CANCELLATION' AND p1.PolicyStatus IN ('WITHDRAWN', 'RESCINDED'))) AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate  AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC), 
		
		--CURRENT
		CurrTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		CurrPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and TransactionType = 'CANCELLATION' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),

		-- LAST
		LastTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1 ,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		LastPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear   and TransactionType = 'CANCELLATION' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		LastNonAuditTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear  and TransactionType NOT IN ('AUDIT') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),

		-- CURRENT NON AUDIT
		CurrNonAuditTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear  and p1.TransactionType NOT IN ('AUDIT') AND ISNULL(PolicyChangeType, 'Rating') = 'Rating' AND p1.PolicyStatus IN ('BOUND') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),
		CurrNonAuditPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1,CTE_MonthParam As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and TransactionType = 'CANCELLATION' AND p1.TransactionType NOT IN ('AUDIT') AND ISNULL(PolicyChangeType, 'Rating') = 'Rating' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),
		
		TotalDays = DATEDIFF(dd, EffectiveDate, ExpirationDate), 
		IIF(RP.ReportEndDate &gt; ExpirationDate, 0, DATEDIFF(dd, RP.ReportEndDate, ExpirationDate)) AS RemainingDays,
		DaysInMonth = DATEDIFF(dd, IIF(p.EffectiveDate &gt;= RP.ReportStartDate, p.EffectiveDate, RP.ReportStartDate), IIF(p.ExpirationDate &gt;= RP.ReportEndDate, RP.ReportEndDate, ExpirationDate-1)) + 1, -- -1 as no coverage on last day of policy
		CASE 
			WHEN ExpirationDate &lt; RP.ReportEndDate THEN DATEDIFF(dd, EffectiveDate, ExpirationDate) + 1
			WHEN EffectiveDate &gt; RP.YTDStartDate THEN DATEDIFF(dd, EffectiveDate, RP.ReportEndDate) + 1
			WHEN EffectiveDate &lt;= RP.YTDStartDate THEN DATEDIFF(dd, EffectiveDate, RP.ReportEndDate) + 1 -- zzz
		END AS ElapsedDays

	FROM DimPolicy p ,CTE_MonthParam As RP
	WHERE
		CONVERT(varchar, p.EffectiveDate, 101) &lt;= RP.ReportEndDate
		AND 
		(
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'SUBMISSION' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate
			OR
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'RENEWAL' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate
			OR
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'REWRITE' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate

		)
		AND ModelNumber IS NOT NULL --and BaseState ='MI'
) a
WHERE RowNumber = 1

) s
WHERE 1=1

)


SELECT * 
FROM 
(
SELECT 
	LookupCol Q_LookupCol, ReportMonth Q_ReportMonth,YearMonth Q_YearMonth, PolicyNumber Q_PolicyNumber,RatingPlan Q_RatingPlan,
	 EffectiveDate Q_EffectiveDate, PremiumState Q_PremiumState,
	MTDWritten Q_MTDWritten, YTDWritten Q_YTDWritten, 
	ExpirationDate Q_ExpirationDate, 
	CancellationDate Q_CancellationDate, Inforce Q_Inforce, 
	MTDEarned Q_MTDEarned,sum(isnull(MTDEarned,0)) OVER (partition by LookupCol,Year order by ReportMonth) As Q_YTDEARNED 
FROM CTE_Temp
) A
WHERE Q_YearMonth &gt;=  @StartYear*100 +  @StartMonth
and Q_YearMonth &lt;=  @EndYear*100 +  @EndMonth</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Pulling Data into stagging table\OLE DB Source.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_LookupCol]"
                      length="81"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_LookupCol]"
                      name="Q_LookupCol"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_ReportMonth]"
                      length="33"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ReportMonth]"
                      name="Q_ReportMonth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YearMonth]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YearMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YearMonth]"
                      name="Q_YearMonth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_PolicyNumber]"
                      length="50"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PolicyNumber]"
                      name="Q_PolicyNumber"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_EffectiveDate]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_EffectiveDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_EffectiveDate]"
                      name="Q_EffectiveDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_PremiumState]"
                      length="2"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PremiumState]"
                      name="Q_PremiumState"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDWritten]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_MTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDWritten]"
                      name="Q_MTDWritten"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDWritten]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDWritten]"
                      name="Q_YTDWritten"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_ExpirationDate]"
                      length="30"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ExpirationDate]"
                      name="Q_ExpirationDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_CancellationDate]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_CancellationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_CancellationDate]"
                      name="Q_CancellationDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_Inforce]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_Inforce]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_Inforce]"
                      name="Q_Inforce"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDEarned]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_MTDEarned]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDEarned]"
                      name="Q_MTDEarned"
                      precision="22"
                      scale="4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDEARNED]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YTDEARNED]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDEARNED]"
                      name="Q_YTDEARNED"
                      precision="38"
                      scale="4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_RatingPlan]"
                      length="256"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_RatingPlan]"
                      name="Q_RatingPlan"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="81"
                      name="Q_LookupCol" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="33"
                      name="Q_ReportMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YearMonth]"
                      dataType="i4"
                      name="Q_YearMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="Q_PolicyNumber" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_EffectiveDate]"
                      dataType="dbTimeStamp"
                      name="Q_EffectiveDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="Q_PremiumState" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_MTDWritten]"
                      dataType="cy"
                      name="Q_MTDWritten" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YTDWritten]"
                      dataType="cy"
                      name="Q_YTDWritten" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="Q_ExpirationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_CancellationDate]"
                      dataType="dbTimeStamp"
                      name="Q_CancellationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_Inforce]"
                      dataType="cy"
                      name="Q_Inforce" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_MTDEarned]"
                      dataType="numeric"
                      name="Q_MTDEarned"
                      precision="22"
                      scale="4" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_YTDEARNED]"
                      dataType="numeric"
                      name="Q_YTDEARNED"
                      precision="38"
                      scale="4" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].ExternalColumns[Q_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="256"
                      name="Q_RatingPlan" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="81"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_LookupCol]"
                      name="Q_LookupCol" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="33"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_ReportMonth]"
                      name="Q_ReportMonth" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YearMonth]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YearMonth]"
                      name="Q_YearMonth" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_PolicyNumber]"
                      name="Q_PolicyNumber" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="256"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_RatingPlan]"
                      name="Q_RatingPlan" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_EffectiveDate]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_EffectiveDate]"
                      name="Q_EffectiveDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_PremiumState]"
                      name="Q_PremiumState" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_MTDWritten]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_MTDWritten]"
                      name="Q_MTDWritten" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YTDWritten]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YTDWritten]"
                      name="Q_YTDWritten" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_ExpirationDate]"
                      name="Q_ExpirationDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_CancellationDate]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_CancellationDate]"
                      name="Q_CancellationDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_Inforce]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_Inforce]"
                      name="Q_Inforce" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_MTDEarned]"
                      dataType="numeric"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_MTDEarned]"
                      name="Q_MTDEarned"
                      precision="22"
                      scale="4" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YTDEARNED]"
                      dataType="numeric"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[Q_YTDEARNED]"
                      name="Q_YTDEARNED"
                      precision="38"
                      scale="4" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Pulling Data into stagging table\OLE DB Source 1"
              componentClassID="Microsoft.OLEDBSource"
              contactInfo="OLE DB Source;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;7"
              description="OLE DB Source"
              name="OLE DB Source 1"
              usesDispositions="true"
              version="7">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset"></property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor">Declare @QuarterEndDate Date;
Declare @QuarterStartDate Date;
Declare @PreviousQuarterStartDate Date;
Declare @PreviousQuarterEndDate Date;
Declare @Scheduled int;
Declare @ReportDate as Date;
Set @ReportDate = (Select Date from DimDate where IsLastDayOfMonth =1 and QuarterofYear = 1 and Year ='2018' and MonthofYear in (3,6,9,12));
SET @QuarterStartDate	 =  DATEADD(q, DATEDIFF(q, 0, @ReportDate), 0);
SET @QuarterEndDate		 =  DATEADD(d, -1, DATEADD(q, DATEDIFF(q, 0, @ReportDate) + 1, 0)) ;
Set @PreviousQuarterStartDate	= DATEADD(qq, DATEDIFF(qq, 0, @QuarterStartDate) -1, 0);
Set @PreviousQuarterEndDate		= DATEADD (dd, -1, DATEADD(qq, DATEDIFF(qq, 0, @QuarterStartDate), 0));
Declare @StartYear int= year(@ReportDate);
Declare @EndMonth int=month(@ReportDate);
Declare @EndYear int= year(@ReportDate);
Declare @startmonth int=month(@QuarterStartDate);

With CTE_MonthParam1 As
(
Select Year,MonthName,MonthofYear,Cast(Min(Date) as date) As 'ReportStartDate',CAst(Max(Date) as date) As 'ReportEndDate',
cast(DATEADD(yy, DATEDIFF(yy, 0, Cast(Min(Date) as date)), 0) as Date) As 'YTDStartDate',
DATEFROMPARTS(DATEPART(yyyy, Cast(Min(Date) as date)) - 1, 1, 1) As  PrevYearStartDate ,
cast(DATEADD(DD, -1, DATEADD(YY, DATEDIFF(yy, 0, Cast(Min(Date) as date)), 0)) as date) As PrevYearEndDate
from DimDate 
where Year*100 + MonthofYear &gt;=  2017*100 +  1
and Year*100 + MonthofYear &lt;=  @EndYear*100 +  @EndMonth
and (DayofMonth = 1  or IsLastDayOfMonth = 1)  
Group by Year,MonthName,MonthofYear 
)

,CTE_Temp1 as (
SELECT 
	LookupCol, ReportMonth,Year,YearMonth, PolicyNumber,RatingPlan, EffectiveDate, PremiumState, 
	MTDWritten, YTDWritten, 
	ExpirationDate, 
	CancellationDate, Inforce, 
	MTDEarned = 
	CASE 
		WHEN CancellationDate &lt;=  ReportStartDate AND CancellationCloseDate &lt;=  ReportStartDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN MTDWritten 
		ELSE MTDEarned 
	END
FROM
(

SELECT
	CONCAT(PolicyNumber, ' ', CAST(EffectiveDate AS varchar)) AS LookupCol, 
	RIGHT('0' + CAST(MONTH( ReportStartDate) AS varchar), 2) + '-' + CAST(YEAR( ReportStartDate) AS varchar) ReportMonth,
	PolicyNumber,RatingPlan, EffectiveDate, PremiumState, ReportStartDate,
		ReportEndDate,Year,YearMonth,

	CASE 
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND CurrTransactionType &lt;&gt; 'AUDIT' THEN 0 
		ELSE CAST(MTDWritten AS money) 
	END AS MTDWritten, 

	CASE 
		WHEN YEAR(EffectiveDate) = YEAR( ReportStartDate) THEN YTDWritten 
		ELSE YTDWritten-YTDWrittenPrev 
	END AS YTDWritten, 

	ExpirationDate, CancellationCloseDate, CancellationWithdrawCloseDate, 

	CASE 
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'SUBMISSION' THEN CancellationDate
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION'  AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN CancellationDate
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN CancellationDate
		WHEN CancellationDate &lt;  ReportStartDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED')  THEN CancellationDate
		WHEN CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN CancellationDate
		WHEN CancellationDate &lt;=  ReportEndDate AND CancellationCloseDate &lt;=  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN CancellationDate
		ELSE NULL 
	END AS CancellationDate, 

	CASE 
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'SUBMISSION' THEN 0
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION'  AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN 0
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN 0
		WHEN CancellationDate &lt;  ReportStartDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED')  THEN 0
		WHEN CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN 0
		WHEN CancellationDate &lt;=  ReportEndDate AND CancellationCloseDate &lt;=  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN 0
		ELSE CAST(YTDWritten AS money) 
	END AS Inforce, 

	CASE
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND Total = LastTotal THEN 0
		WHEN DATEDIFF(mm,  ReportEndDate, ExpirationDate) &lt; 0 AND Total &lt;&gt; LastTotal THEN Total - LastTotal 
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate &lt;  ReportStartDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN 0 

		WHEN (CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate OR CancellationDate &gt;  ReportEndDate) AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate AND Total = 0 THEN 0 
		WHEN (CancellationDate BETWEEN  ReportStartDate AND  ReportEndDate OR CancellationDate &gt;  ReportEndDate) AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate AND LastNonAuditTransactionType = 'CANCELLATION' THEN Total - LastTotal -- Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)
		WHEN CancellationDate &lt;  ReportStartDate AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND ISNULL(CancellationWithdrawCloseDate, '1/1/1900') &lt;= CancellationCloseDate THEN Total-CAST(LastTotal/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate,  ReportStartDate)

		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal
		WHEN CurrTransactionType = 'AUDIT' AND CurrNonAuditTransactionType = 'CANCELLATION' AND CurrNonAuditPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND LastTransactionType = 'AUDIT' THEN Total - LastTotal -- ARP120000089
		WHEN LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CancellationCloseDate BETWEEN  ReportStartDate AND  ReportEndDate AND CancellationDate &lt;=  ReportEndDate THEN Total - LastTotal
		WHEN LastNonAuditTransactionType = 'CANCELLATION' AND CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal		
		WHEN LastTransactionType = 'CANCELLATION' AND LastPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND ISNULL(CurrTransactionType, '') &lt;&gt; 'CANCELLATION' THEN CAST(Total/TotalDays AS decimal(10,4))*(DaysInMonth + DATEDIFF(dd, EffectiveDate,  ReportStartDate)) - LastTotal-- WHEN Cancellation was bound last month, hence everything was earned by in last month itself -- -- ARP120000468
		WHEN LastNonAuditTransactionType = 'CANCELLATION' AND CurrTransactionType = 'Audit' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') THEN Total - LastTotal	-- zz
		WHEN CurrTransactionType = 'CANCELLATION' AND CurrPolicyStatus NOT IN ('WITHDRAWN', 'RESCINDED') AND CancellationDate &lt;= ReportEndDate THEN Total-CAST((Total+(MTDWritten*-1))/TotalDays*DATEDIFF(dd, EffectiveDate, ReportStartDate) AS decimal(10,4))
		
		ELSE 
			CAST(Total/TotalDays AS decimal(10,4))*(DaysInMonth + CASE WHEN EffectiveDate &lt; ReportStartDate AND Total = MTDWritten THEN DATEDIFF(dd, EffectiveDate, ReportStartDate) ELSE 0 END)  -- ARP120000166
			+
			CASE WHEN EffectiveDate &lt; ReportStartDate AND Total &lt;&gt; MTDWritten AND MTDWritten &lt;&gt; 0 THEN CAST(MTDWritten/TotalDays AS decimal(10,4))*DATEDIFF(dd, EffectiveDate, ReportStartDate) ELSE 0 END -- ARP120000009
	END AS MTDEarned, 

	CurrTransactionType, CurrPolicyStatus, LastTransactionType, LastPolicyStatus, CurrNonAuditTransactionType, CurrNonAuditPolicyStatus, LastNonAuditTransactionType, 
	Total, LastTotal, TotalDays, ElapsedDays, DaysInMonth
FROM
(
	SELECT 
		ROW_NUMBER() OVER(PARTITION BY p.PolicyNumber, p.EffectiveDate,RP.Year,RP.MonthName ORDER BY CAST(CONVERT(VARCHAR, p.JobCloseDate, 101) AS datetime) DESC) RowNumber, 
		p.PolicyNumber, p.RatingPlan, p.BaseState PremiumState, 
		Year(EffectiveDate)PolicyYear,
		p.EffectiveDate,
		CONVERT(varchar, p.ExpirationDate, 101) ExpirationDate, 
		RP.ReportStartDate,
		RP.ReportEndDate,
		RP.Year,RP.Year*100 + RP.MonthofYear As YearMonth,

		Total = (SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'SUBMISSION', 'REINSTATEMENT', 'AUDIT', 'RENEWAL', 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC), 
		LastTotal = ISNULL((SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'SUBMISSION', 'REINSTATEMENT', 'AUDIT', 'RENEWAL', 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC), 0),

		MTDWritten =
		COALESCE
		(
			(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, CAST(CONVERT(VARCHAR, p1.EffectiveDate, 101) AS datetime), CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate  ORDER BY IIF(CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate, 1, 2), p1.JobCloseDate DESC)
			-
			ISNULL((SELECT top 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'SUBMISSION', 'RENEWAL', 'REWRITE', 'AUDIT') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, p1.EffectiveDate, CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) &lt; RP1.ReportStartDate ORDER BY IIF(p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT'), 1, 2), p1.JobCloseDate DESC),  0)
			,
			ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND IIF(p1.EffectiveDate &gt; p1.JobCloseDate, CAST(CONVERT(VARCHAR, p1.EffectiveDate, 101) AS datetime), CAST(CONVERT(VARCHAR, p1.JobCloseDate, 101) AS datetime)) BETWEEN RP1.ReportStartDate AND RP1.ReportEndDate), 0)
		),

		YTDWritten =
		COALESCE
		(
		(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.ReportEndDate  ORDER BY p1.JobCloseDate DESC)
		,
		ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and  (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.ReportEndDate), 0)
		),

		YTDWrittenPrev =
		COALESCE
		(
		(SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'CANCELLATION', 'REINSTATEMENT', 'AUDIT')	AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CAST(CONVERT(varchar, p1.JobCloseDate, 101) AS datetime) BETWEEN RP1.PrevYearStartDate AND RP1.PrevYearEndDate  ORDER BY p1.JobCloseDate DESC)
		,
		ISNULL((SELECT p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and (p1.TransactionType = 'SUBMISSION' OR p1.TransactionType = 'RENEWAL' OR p1.TransactionType = 'REWRITE') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) BETWEEN RP1.PrevYearStartDate AND RP1.PrevYearEndDate), 0)
		),
		
		Inforce = ISNULL((SELECT TOP 1 p1.TotalPremium FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType IN ('POLICY CHANGE', 'SUBMISSION') AND p1.PolicyStatus = 'BOUND' and p1.PolicyNumber = p.PolicyNumber and p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate AND CONVERT(varchar, p1.ExpirationDate, 101) &gt; RP1.ReportEndDate ORDER BY CASE WHEN p1.TransactionType = 'POLICY CHANGE' THEN 1 ELSE 2 END, p1.JobCloseDate), 0), 

		--Cancellation
		CancellationDate = (SELECT TOP 1 CAST(CONVERT(varchar, CancellationDate, 101)AS datetime) FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.TransactionType = 'CANCELLATION' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),  
		CancellationCloseDate = (SELECT TOP 1 JobCloseDate FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and  p1.TransactionType IN ('CANCELLATION') AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate  AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC), 
		CancellationWithdrawCloseDate = (SELECT TOP 1 JobCloseDate FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and ((p1.TransactionType = 'REINSTATEMENT' AND p1.PolicyStatus = 'BOUND') OR (p1.TransactionType = 'CANCELLATION' AND p1.PolicyStatus IN ('WITHDRAWN', 'RESCINDED'))) AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate  AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC), 
		
		--CURRENT
		CurrTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		CurrPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and TransactionType = 'CANCELLATION' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),

		-- LAST
		LastTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1 ,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		LastPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear   and TransactionType = 'CANCELLATION' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),
		LastNonAuditTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear  and TransactionType NOT IN ('AUDIT') AND p1.PolicyStatus IN ('BOUND', 'COMPLETED') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt; RP1.ReportStartDate ORDER BY p1.JobCloseDate DESC, CASE WHEN p1.PolicyStatus = 'BOUND' THEN 1 ELSE 2 END),

		-- CURRENT NON AUDIT
		CurrNonAuditTransactionType = (SELECT TOP 1 TransactionType FROM DimPolicy p1,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear  and p1.TransactionType NOT IN ('AUDIT') AND ISNULL(PolicyChangeType, 'Rating') = 'Rating' AND p1.PolicyStatus IN ('BOUND') AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),
		CurrNonAuditPolicyStatus = (SELECT TOP 1 PolicyStatus FROM DimPolicy p1,CTE_MonthParam1 As RP1 WHERE RP1.Year = RP.Year and RP1.MonthofYear = RP.MonthofYear and TransactionType = 'CANCELLATION' AND p1.TransactionType NOT IN ('AUDIT') AND ISNULL(PolicyChangeType, 'Rating') = 'Rating' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate AND CONVERT(varchar, p1.JobCloseDate, 101) &lt;= RP1.ReportEndDate ORDER BY p1.JobCloseDate DESC),
		
		TotalDays = DATEDIFF(dd, EffectiveDate, ExpirationDate), 
		IIF(RP.ReportEndDate &gt; ExpirationDate, 0, DATEDIFF(dd, RP.ReportEndDate, ExpirationDate)) AS RemainingDays,
		DaysInMonth = DATEDIFF(dd, IIF(p.EffectiveDate &gt;= RP.ReportStartDate, p.EffectiveDate, RP.ReportStartDate), IIF(p.ExpirationDate &gt;= RP.ReportEndDate, RP.ReportEndDate, ExpirationDate-1)) + 1, -- -1 as no coverage on last day of policy
		CASE 
			WHEN ExpirationDate &lt; RP.ReportEndDate THEN DATEDIFF(dd, EffectiveDate, ExpirationDate) + 1
			WHEN EffectiveDate &gt; RP.YTDStartDate THEN DATEDIFF(dd, EffectiveDate, RP.ReportEndDate) + 1
			WHEN EffectiveDate &lt;= RP.YTDStartDate THEN DATEDIFF(dd, EffectiveDate, RP.ReportEndDate) + 1 -- zzz
		END AS ElapsedDays

	FROM DimPolicy p ,CTE_MonthParam1 As RP
	WHERE
		CONVERT(varchar, p.EffectiveDate, 101) &lt;= RP.ReportEndDate
		AND 
		(
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'SUBMISSION' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate
			OR
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'RENEWAL' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate
			OR
			CONVERT(varchar, (SELECT p1.JobCloseDate FROM DimPolicy p1 WHERE p1.TransactionType = 'REWRITE' AND p1.PolicyStatus = 'BOUND' AND p1.PolicyNumber = p.PolicyNumber AND p1.EffectiveDate = p.EffectiveDate), 101) &lt;= RP.ReportEndDate

		)
		AND ModelNumber IS NOT NULL --and BaseState ='MI'
) a
WHERE RowNumber = 1

) s
WHERE 1=1

)



SELECT *
FROM 
(
SELECT 
	LookupCol A_LookupCol, ReportMonth A_ReportMonth,YearMonth A_YearMonth, PolicyNumber A_PolicyNumber,RatingPlan A_RatingPlan,
	EffectiveDate A_EffectiveDate, PremiumState A_PremiumState,
	MTDWritten A_MTDWritten, YTDWritten A_YTDWritten, 
	ExpirationDate A_ExpirationDate, 
	CancellationDate A_CancellationDate, Inforce A_Inforce, 
	MTDEarned A_MTDEarned,sum(isnull(MTDEarned,0)) OVER (partition by LookupCol,Year order by ReportMonth) As A_YTDEARNED 
FROM CTE_Temp1
) A
WHERE A_YearMonth &gt;=  2017*100 +  1
and A_YearMonth &lt;=  @EndYear*100 +  @EndMonth</property>
                <property
                  dataType="System.String"
                  description="The variable that contains the SQL command to be executed."
                  name="SqlCommandVariable"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">2</property>
                <property
                  dataType="System.String"
                  description="The mappings between the parameters in the SQL command and variables."
                  name="ParameterMapping"></property>
              </properties>
              <connections>
                <connection
                  refId="Package\Pulling Data into stagging table\OLE DB Source 1.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <outputs>
                <output
                  refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output]"
                  name="OLE DB Source Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_LookupCol]"
                      length="81"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_LookupCol]"
                      name="A_LookupCol"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_ReportMonth]"
                      length="33"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ReportMonth]"
                      name="A_ReportMonth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YearMonth]"
                      dataType="i4"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YearMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YearMonth]"
                      name="A_YearMonth"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_PolicyNumber]"
                      length="50"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PolicyNumber]"
                      name="A_PolicyNumber"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_EffectiveDate]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_EffectiveDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_EffectiveDate]"
                      name="A_EffectiveDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_PremiumState]"
                      length="2"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_PremiumState]"
                      name="A_PremiumState"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDWritten]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_MTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDWritten]"
                      name="A_MTDWritten"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDWritten]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDWritten]"
                      name="A_YTDWritten"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_ExpirationDate]"
                      length="30"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_ExpirationDate]"
                      name="A_ExpirationDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_CancellationDate]"
                      dataType="dbTimeStamp"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_CancellationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_CancellationDate]"
                      name="A_CancellationDate"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_Inforce]"
                      dataType="cy"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_Inforce]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_Inforce]"
                      name="A_Inforce"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDEarned]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_MTDEarned]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_MTDEarned]"
                      name="A_MTDEarned"
                      precision="22"
                      scale="4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDEARNED]"
                      dataType="numeric"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YTDEARNED]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_YTDEARNED]"
                      name="A_YTDEARNED"
                      precision="38"
                      scale="4"
                      truncationRowDisposition="FailComponent" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      errorOrTruncationOperation="Conversion"
                      errorRowDisposition="FailComponent"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_RatingPlan]"
                      length="256"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].Columns[A_RatingPlan]"
                      name="A_RatingPlan"
                      truncationRowDisposition="FailComponent" />
                  </outputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="81"
                      name="A_LookupCol" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="33"
                      name="A_ReportMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YearMonth]"
                      dataType="i4"
                      name="A_YearMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      name="A_PolicyNumber" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_EffectiveDate]"
                      dataType="dbTimeStamp"
                      name="A_EffectiveDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      name="A_PremiumState" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_MTDWritten]"
                      dataType="cy"
                      name="A_MTDWritten" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YTDWritten]"
                      dataType="cy"
                      name="A_YTDWritten" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      name="A_ExpirationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_CancellationDate]"
                      dataType="dbTimeStamp"
                      name="A_CancellationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_Inforce]"
                      dataType="cy"
                      name="A_Inforce" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_MTDEarned]"
                      dataType="numeric"
                      name="A_MTDEarned"
                      precision="22"
                      scale="4" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_YTDEARNED]"
                      dataType="numeric"
                      name="A_YTDEARNED"
                      precision="38"
                      scale="4" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output].ExternalColumns[A_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="256"
                      name="A_RatingPlan" />
                  </externalMetadataColumns>
                </output>
                <output
                  refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output]"
                  isErrorOut="true"
                  name="OLE DB Source Error Output">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="81"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_LookupCol]"
                      name="A_LookupCol" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="33"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_ReportMonth]"
                      name="A_ReportMonth" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YearMonth]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YearMonth]"
                      name="A_YearMonth" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="50"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_PolicyNumber]"
                      name="A_PolicyNumber" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="256"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_RatingPlan]"
                      name="A_RatingPlan" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_EffectiveDate]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_EffectiveDate]"
                      name="A_EffectiveDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="2"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_PremiumState]"
                      name="A_PremiumState" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_MTDWritten]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_MTDWritten]"
                      name="A_MTDWritten" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YTDWritten]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YTDWritten]"
                      name="A_YTDWritten" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_ExpirationDate]"
                      codePage="1252"
                      dataType="str"
                      length="30"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_ExpirationDate]"
                      name="A_ExpirationDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_CancellationDate]"
                      dataType="dbTimeStamp"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_CancellationDate]"
                      name="A_CancellationDate" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_Inforce]"
                      dataType="cy"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_Inforce]"
                      name="A_Inforce" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_MTDEarned]"
                      dataType="numeric"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_MTDEarned]"
                      name="A_MTDEarned"
                      precision="22"
                      scale="4" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YTDEARNED]"
                      dataType="numeric"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[A_YTDEARNED]"
                      name="A_YTDEARNED"
                      precision="38"
                      scale="4" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
            <component
              refId="Package\Pulling Data into stagging table\QStagging"
              componentClassID="Microsoft.OLEDBDestination"
              contactInfo="OLE DB Destination;Microsoft Corporation; Microsoft SQL Server; (C) Microsoft Corporation; All Rights Reserved; http://www.microsoft.com/sql/support;4"
              description="OLE DB Destination"
              name="QStagging"
              usesDispositions="true"
              version="4">
              <properties>
                <property
                  dataType="System.Int32"
                  description="The number of seconds before a command times out.  A value of 0 indicates an infinite time-out."
                  name="CommandTimeout">0</property>
                <property
                  dataType="System.String"
                  description="Specifies the name of the database object used to open a rowset."
                  name="OpenRowset">[dbo].[OnsiteAuditWrittenPremiumQStagging]</property>
                <property
                  dataType="System.String"
                  description="Specifies the variable that contains the name of the database object used to open a rowset."
                  name="OpenRowsetVariable"></property>
                <property
                  dataType="System.String"
                  description="The SQL command to be executed."
                  name="SqlCommand"
                  UITypeEditor="Microsoft.DataTransformationServices.Controls.ModalMultilineStringEditor"></property>
                <property
                  dataType="System.Int32"
                  description="Specifies the column code page to use when code page information is unavailable from the data source."
                  name="DefaultCodePage">1252</property>
                <property
                  dataType="System.Boolean"
                  description="Forces the use of the DefaultCodePage property value when describing character data."
                  name="AlwaysUseDefaultCodePage">false</property>
                <property
                  dataType="System.Int32"
                  description="Specifies the mode used to access the database."
                  name="AccessMode"
                  typeConverter="AccessMode">3</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the values supplied for identity columns will be copied to the destination. If false, values for identity columns will be auto-generated at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepIdentity">false</property>
                <property
                  dataType="System.Boolean"
                  description="Indicates whether the columns containing null will have null inserted in the destination. If false, columns containing null will have their default values inserted at the destination. Applies only if fast load is turned on."
                  name="FastLoadKeepNulls">false</property>
                <property
                  dataType="System.String"
                  description="Specifies options to be used with fast load.  Applies only if fast load is turned on."
                  name="FastLoadOptions">TABLOCK,CHECK_CONSTRAINTS</property>
                <property
                  dataType="System.Int32"
                  description="Specifies when commits are issued during data insertion.  A value of 0 specifies that one commit will be issued at the end of data insertion.  Applies only if fast load is turned on."
                  name="FastLoadMaxInsertCommitSize">2147483647</property>
              </properties>
              <connections>
                <connection
                  refId="Package\Pulling Data into stagging table\QStagging.Connections[OleDbConnection]"
                  connectionManagerID="{E94F6E71-897C-4942-987F-A82A693C0EAD}:external"
                  connectionManagerRefId="Project.ConnectionManagers[EDW]"
                  description="The OLE DB runtime connection used to access the database."
                  name="OleDbConnection" />
              </connections>
              <inputs>
                <input
                  refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input]"
                  errorOrTruncationOperation="Insert"
                  errorRowDisposition="FailComponent"
                  hasSideEffects="true"
                  name="OLE DB Destination Input">
                  <inputColumns>
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_LookupCol]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="81"
                      cachedName="Q_LookupCol"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_LookupCol]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_LookupCol]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_ReportMonth]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="33"
                      cachedName="Q_ReportMonth"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_ReportMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ReportMonth]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_YearMonth]"
                      cachedDataType="i4"
                      cachedName="Q_YearMonth"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YearMonth]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YearMonth]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_PolicyNumber]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="50"
                      cachedName="Q_PolicyNumber"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_PolicyNumber]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PolicyNumber]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_EffectiveDate]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Q_EffectiveDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_EffectiveDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_EffectiveDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_PremiumState]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="2"
                      cachedName="Q_PremiumState"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_PremiumState]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_PremiumState]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_MTDWritten]"
                      cachedDataType="cy"
                      cachedName="Q_MTDWritten"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_MTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDWritten]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_YTDWritten]"
                      cachedDataType="cy"
                      cachedName="Q_YTDWritten"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YTDWritten]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDWritten]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_ExpirationDate]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="30"
                      cachedName="Q_ExpirationDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_ExpirationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_ExpirationDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_CancellationDate]"
                      cachedDataType="dbTimeStamp"
                      cachedName="Q_CancellationDate"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_CancellationDate]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_CancellationDate]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_Inforce]"
                      cachedDataType="cy"
                      cachedName="Q_Inforce"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_Inforce]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_Inforce]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_MTDEarned]"
                      cachedDataType="numeric"
                      cachedName="Q_MTDEarned"
                      cachedPrecision="22"
                      cachedScale="4"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_MTDEarned]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_MTDEarned]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_YTDEARNED]"
                      cachedDataType="numeric"
                      cachedName="Q_YTDEARNED"
                      cachedPrecision="38"
                      cachedScale="4"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YTDEARNED]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_YTDEARNED]" />
                    <inputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].Columns[Q_RatingPlan]"
                      cachedCodepage="1252"
                      cachedDataType="str"
                      cachedLength="256"
                      cachedName="Q_RatingPlan"
                      externalMetadataColumnId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_RatingPlan]"
                      lineageId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output].Columns[Q_RatingPlan]" />
                  </inputColumns>
                  <externalMetadataColumns
                    isUsed="True">
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_LookupCol]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_LookupCol" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_ReportMonth]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_ReportMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YearMonth]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_YearMonth" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_PolicyNumber]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_PolicyNumber" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_RatingPlan]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_RatingPlan" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_EffectiveDate]"
                      dataType="dbTimeStamp"
                      name="Q_EffectiveDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_PremiumState]"
                      codePage="1252"
                      dataType="str"
                      length="255"
                      name="Q_PremiumState" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_MTDWritten]"
                      dataType="numeric"
                      name="Q_MTDWritten"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YTDWritten]"
                      dataType="numeric"
                      name="Q_YTDWritten"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_ExpirationDate]"
                      dataType="dbTimeStamp"
                      name="Q_ExpirationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_CancellationDate]"
                      dataType="dbTimeStamp"
                      name="Q_CancellationDate" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_Inforce]"
                      dataType="numeric"
                      name="Q_Inforce"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_MTDEarned]"
                      dataType="numeric"
                      name="Q_MTDEarned"
                      precision="12"
                      scale="2" />
                    <externalMetadataColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input].ExternalColumns[Q_YTDEARNED]"
                      dataType="numeric"
                      name="Q_YTDEARNED"
                      precision="12"
                      scale="2" />
                  </externalMetadataColumns>
                </input>
              </inputs>
              <outputs>
                <output
                  refId="Package\Pulling Data into stagging table\QStagging.Outputs[OLE DB Destination Error Output]"
                  exclusionGroup="1"
                  isErrorOut="true"
                  name="OLE DB Destination Error Output"
                  synchronousInputId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input]">
                  <outputColumns>
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\QStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorCode]"
                      name="ErrorCode"
                      specialFlags="1" />
                    <outputColumn
                      refId="Package\Pulling Data into stagging table\QStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      dataType="i4"
                      lineageId="Package\Pulling Data into stagging table\QStagging.Outputs[OLE DB Destination Error Output].Columns[ErrorColumn]"
                      name="ErrorColumn"
                      specialFlags="2" />
                  </outputColumns>
                  <externalMetadataColumns />
                </output>
              </outputs>
            </component>
          </components>
          <paths>
            <path
              refId="Package\Pulling Data into stagging table.Paths[OLE DB Source Output]"
              endId="Package\Pulling Data into stagging table\QStagging.Inputs[OLE DB Destination Input]"
              name="OLE DB Source Output"
              startId="Package\Pulling Data into stagging table\OLE DB Source.Outputs[OLE DB Source Output]" />
            <path
              refId="Package\Pulling Data into stagging table.Paths[OLE DB Source Output1]"
              endId="Package\Pulling Data into stagging table\AStagging.Inputs[OLE DB Destination Input]"
              name="OLE DB Source Output"
              startId="Package\Pulling Data into stagging table\OLE DB Source 1.Outputs[OLE DB Source Output]" />
          </paths>
        </pipeline>
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Truncating Tables"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{AEF32E22-56FA-4A51-99B3-4CD37E4C5431}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Truncating Tables"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; SQL Server 2016; © 2015 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{E94F6E71-897C-4942-987F-A82A693C0EAD}"
          SQLTask:SqlStatementSource="Truncate Table OnsiteAuditWrittenPremium;&#xA;Truncate Table OnsiteAuditWrittenPremiumAStagging;&#xA;Truncate Table OnsiteAuditWrittenPremiumQStagging;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{A4D0CB02-2053-43EF-9EAA-4754A73AB022}"
      DTS:From="Package\Truncating Tables"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Pulling Data into stagging table" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{8F4D1EC1-A349-4394-B9F7-0339A2F1659D}"
      DTS:From="Package\pulling data into final table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Generating Files" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{1253CA49-4BDA-4EAA-B980-4877E890DEB9}"
      DTS:From="Package\Pulling Data into stagging table"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\pulling data into final table" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="156,42.6666666666667"
          Id="Package\Generating Files"
          TopLeft="90.8333319798112,111.366664675275" />
        <NodeLayout
          Size="205.333333333334,42.6666666666667"
          Id="Package\pulling data into final table"
          TopLeft="309.99999538064,115.266664605538" />
        <NodeLayout
          Size="226.666666666667,42.6666666666667"
          Id="Package\Pulling Data into stagging table"
          TopLeft="302.083328831941,33.3666660700242" />
        <NodeLayout
          Size="164,42.6666666666667"
          Id="Package\Truncating Tables"
          TopLeft="96.2499985657632,31.1999994421005" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="260.249998565763,53.6166660893957">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="41.8333302661773,0"
              Start="0,0"
              End="34.3333302661773,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="34.3333302661773,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="309.99999538064,134.64999797374">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-63.1666634008291,0"
              Start="0,0"
              End="-55.6666634008291,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-55.6666634008291,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="414.04166210629,76.0333327366909">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,39.2333318688474"
              Start="0,0"
              End="0,31.7333318688474">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,31.7333318688474" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <TaskHost
    design-time-name="Package\Generating Files">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="150.666666666667,42.6666666666667"
          Id="Package\Generating Files\OLE DB Source"
          TopLeft="326.666666666667,101.333333333333" />
        <NodeLayout
          Size="172,42.6666666666667"
          Id="Package\Generating Files\Flat File Destination"
          TopLeft="310,211.333333333333" />
        <EdgeLayout
          Id="Package\Generating Files.Paths[OLE DB Source Output]"
          TopLeft="399,144">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,67.3333333333333"
              Start="0,0"
              End="0,59.8333333333333">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,59.8333333333333" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Generating Files\OLE DB Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\pulling data into final table">
    <LayoutInfo>
      <GraphLayout
        Capacity="4" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="150.666666666667,42.6666666666667"
          Id="Package\pulling data into final table\OLE DB Source"
          TopLeft="261.805551654349,111.611109910078" />
        <NodeLayout
          Size="172,42.6666666666667"
          Id="Package\pulling data into final table\OLE DB Destination"
          TopLeft="258.249994443108,230.999993568659" />
        <EdgeLayout
          Id="Package\pulling data into final table.Paths[OLE DB Source Output]"
          TopLeft="340.694439715395,154.277776576745">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,76.7222169919146"
              Start="0,0"
              End="0,69.2222169919146">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,69.2222169919146" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\pulling data into final table\OLE DB Destination">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\pulling data into final table\OLE DB Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <TaskHost
    design-time-name="Package\Pulling Data into stagging table">
    <LayoutInfo>
      <GraphLayout
        Capacity="8" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="160,42.6666666666667"
          Id="Package\Pulling Data into stagging table\OLE DB Source 1"
          TopLeft="594,60.6666666666667" />
        <NodeLayout
          Size="150.666666666667,42.6666666666667"
          Id="Package\Pulling Data into stagging table\OLE DB Source"
          TopLeft="244.666666666667,56.6666666666667" />
        <NodeLayout
          Size="126.666666666667,42.6666666666667"
          Id="Package\Pulling Data into stagging table\AStagging"
          TopLeft="613.333334277074,159.533334867557" />
        <NodeLayout
          Size="128,42.6666666666667"
          Id="Package\Pulling Data into stagging table\QStagging"
          TopLeft="259.416667430352,139.033334983786" />
        <EdgeLayout
          Id="Package\Pulling Data into stagging table.Paths[OLE DB Source Output1]"
          TopLeft="675.333333805204,103.333333333333">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,56.2000015342232"
              Start="0,0"
              End="0,48.7000015342232">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,48.7000015342232" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package\Pulling Data into stagging table.Paths[OLE DB Source Output]"
          TopLeft="321.708333715176,99.3333333333334">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,39.7000016504522"
              Start="0,0"
              End="0,32.2000016504522">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,32.2000016504522" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </TaskHost>
  <PipelineComponentMetadata
    design-time-name="Package\Pulling Data into stagging table\OLE DB Source 1">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Pulling Data into stagging table\OLE DB Source">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Pulling Data into stagging table\AStagging">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
  <PipelineComponentMetadata
    design-time-name="Package\Pulling Data into stagging table\QStagging">
    <Properties>
      <Property>
        <Name>DataSourceViewID</Name>
      </Property>
      <Property>
        <Name>TableInfoObjectType</Name>
        <Value
          type="q2:string">Table</Value>
      </Property>
    </Properties>
  </PipelineComponentMetadata>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>